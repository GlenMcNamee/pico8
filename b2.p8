pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
//
// boulder game v2
// 
// by glen mcnamee
//

function _init()
	game_state = 0
	game_substate = 0 
	space=0
	player=1
	wall=2
	door=3
	thickwall=4
	muck=5
	boulder=6
	diamond=7
	water=8
	npc1=9
	npc2=10
	xlimit=40
	ylimit=22
 cave = {{},{}}
	cave[1] = {0x01, 0x14, 0x0a, 0x0f, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x96, 0x6e, 0x46, 0x28, 0x1e, 0x08, 0x0b, 0x09, 0xd4, 0x20, 0x00, 0x10, 0x14, 0x00, 0x3c, 0x32, 0x09, 0x00, 0x42, 0x01, 0x09, 0x1e, 0x02, 0x42, 0x09, 0x10, 0x1e, 0x02, 0x25, 0x03, 0x04, 0x04, 0x26, 0x12, 0xff},
	{}

end 

function _update()
	if game_state == 0 then _intro() end	
	if game_state == 1 then _titlescreen() end	
	if game_state == 2 then _init_game() end	
	if game_state == 3 then _init_level() end	
	if game_state == 4 then _main_game() end	
	if game_state == 5 then _end_game() end	
	if game_state == 5 then end	
end
-->8
//
// intro and titlescreen
//

function _intro()
 game_state = 1
end

function _titlescreen()
 game_state = 2
end

function _howtoplay()
end
-->8
//
// init game and level
//

function _init_game()
 game_state = 3
end

function _init_level()
level = 1

cave_number = cave[level][1]
milling_time = cave[level][2]
initial_diamond_value = cave[level][3]
extra_diamond_value = cave[level][4]
initial_randomiser_seed_value_for_difficulty_level_1 = cave[level][5]
initial_randomiser_seed_value_for_difficulty_level_2 = cave[level][6]
initial_randomiser_seed_value_for_difficulty_level_3 = cave[level][7]
initial_randomiser_seed_value_for_difficulty_level_4 = cave[level][8]
initial_randomiser_seed_value_for_difficulty_level_5 = cave[level][9]
diamonds_needed_on_difficulty_level_1 = cave[level][10]
diamonds_needed_on_difficulty_level_2 = cave[level][11]
diamonds_needed_on_difficulty_level_3 = cave[level][12]
diamonds_needed_on_difficulty_level_4 = cave[level][13]
diamonds_needed_on_difficulty_level_5 = cave[level][14]
cave_time_for_difficulty_level_1 = cave[level][15]
cave_time_for_difficulty_level_2 = cave[level][16]
cave_time_for_difficulty_level_3 = cave[level][17]
cave_time_for_difficulty_level_4 = cave[level][18]
cave_time_for_difficulty_level_5 = cave[level][19]
background_colour_1 = cave[level][20]
background_colour_2 = cave[level][21]
foreground_colour = cave[level][22]
unused1 = cave[level][23]
unused2 = cave[level][24]
random_object_number_1 = cave[level][25]
random_object_number_2 = cave[level][26]
random_object_number_3 = cave[level][27]
random_object_number_4 = cave[level][28]
probability_of_object_1 = cave[level][29]
probability_of_object_2 = cave[level][30]
probability_of_object_3 = cave[level][31]
probability_of_object_4 = cave[level][32]

	//space: 23%
	//boulder: 19%
 //diamond: 3%
 srand (cave[level][5])
 for x=0,xlimit do
  for y=0,ylimit do
  numb = flr(rnd(256))
  mat = muck
		if numb>54 then mat=space end
		if numb>77 then mat=boulder end
  if numb>96 then mat=diamond end
  if x==0 or y==0 or x==xlimit or y==ylimit then mat=wall end
   mset(x+16,y,mat)
  end
 end

 game_state = 4
end

function _level_draw()
end


-->8
//
// gameloop
//

function _main_game()
end
-->8
//
// player stuff
//

function _ply()
end
-->8
//
// npc stuff 
//

function _npc()
end
-->8
//
// level complete / end game
//

function _level_complete()
end

function _end_game()
end


-->8
//
// draw functions
//

function _draw()
 cls(0)
 for x=0,xlimit do
  for y=0,ylimit do
   pset (x,y,mget(x+16,y))
  	//draw x,y
  end
 end
end

function _gui()

end
__gfx__
00000000005005005555555555555555566656665444404500777700000450003bbb3bbb55555555500000040000000000000000000000000000000000000000
000000000055550050055005500000055555555544054404077664700040050003bbbbb350000005550000440000000000000000000000000000000000000000
007007000505505057055705500000056656665654444544774646670466665003bbbbb350555505665004660000000000000000000000000000000000000000
00077000005555005555555550000005555555554045044056655567477777753bbbbbb350577505777547770000000000000000000000000000000000000000
000770000507705055555555500000055666566645444444544454745777777703bbbb3050577505777757770000000000000000000000000000000000000000
007007000005500050055005500000055555555504044405555555540566667003bbbb3050555505667005660000000000000000000000000000000000000000
00000000000770005705570550000005665666564044044405554550005007003bbbbbb350000005770000550000000000000000000000000000000000000000
0000000000700700555555555555555555555555540454050055550000057000bbbbbbbb55555555700000050000000000000000000000000000000000000000
3bbb3bbbbbb303bbbb30003bbbb303bb555555550000000055555555777777770004500000045000000450000004500000045000000450000000000000000000
03bbbbb33bbb3bb3bbb303b33bbb3bb3500000050555555057777775755555570040050000466500004775000047750000466500004005000000000000000000
03bbbbb303bbbb303bbb3b3003bbbb30505555050577775057555575750000570466665004777750047777500466665004000050040000500000000000000000
3bbbbbb33bbbbb30bbbbbbb33bbbbb30505775050575575057500575750550574777777547777775466666654000000540000005466666650000000000000000
03bbbb303bbbbbb3bbbbbbbb3bbbbbb3505775050575575057500575750550575777777756666667500000075000000756666667577777770000000000000000
03bbbb3003bbbb30bbbb3bbb03bbbb30505555050577775057555575750000570566667005000070050000700566667005777770057777700000000000000000
3bbbbbb33bbb3bb3bbb303bb3bbb3bb3500000050555555057777775755555570050070000500700005667000057770000577700005667000000000000000000
bbbbbbbbbbb303bbbb30003bbbb303bb555555550000000055555555777777770005700000057000000570000005700000057000000570000000000000000000
00000000000000000000000000000000500000040500004000500400050000400000000000000000000000000404005000045000000450000000000000000000
00000000000000000000000000000000550000440500004000500400050000400000000000000000004000000040000500400000004005000000000000000000
00000000000000000000000000000000665004660750047000500400075004700000000000004000000040004000400004004050040000500000000000000000
00000000000000000000000000000000777547770775477000754700077547700000400000404700004047004040470500400705400000050000000000000000
00000000000000000000000000000000777757770667566000675600066756600004000000740400007404005074040750700407500000070000000000000000
00000000000000000000000000000000667005660770055000700500077005500000000000070000000700000007000005070000050000700000000000000000
00000000000000000000000000000000770000550700005000700500070000500000000000000000000000705000007000000700005007000000000000000000
00000000000000000000000000000000700000050700005000700500070000500000000000000000000000000505707000057000000570000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
049999999999a000000499999999a000049999a0000999a00000000004999999999999a0049999999999a0009999a000000499999999a00004999999999999a0
049999a0000999a0049999a0000999a0049999a0000999a000000000049999a000000000049999a0000499a0000499a0049999a0000499a0049999a000000000
0499999999999000049999a0000999a0049999a0000999a000000000049999a0999a000004999999999990000000000004999999999999a004999999999a0000
049999a0000999a0049999a0000999a0049999a0000999a000000000049999a000000000049999a0000499a000000000049999a0000499a0049999a000000000
049999a0000999a0049999a0000999a0049999a0000999a000000000049999a000000000049999a0000499a0000499a0049999a0000499a0049999a000000000
04999999999999a004999999999999a004999999999999a0999999a004999999999999a0049999a0000499a0999999a0049999a0000499a0049999a000000000
049999999999a000000499999999a00004999999999999a0999999a004999999999999a0049999a0000499a09999a000049999a0000499a0049999a000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
04999999999999a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000049999a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000049999a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000049999a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000049999a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000049999a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000049999a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555555555555555555555555555555555555555555555555555555555555555555555555555111111111051105110011001111111110000000000000000
55aaaa55555aa5555aaaaa555aaaaa555aa55aa55aaaaaa555aaaaa55aaaaaa555aaaa5555aaaa55105110511001100111111111111111110000000000000000
5aa55aa555aaa55555555aa555555aa55aa55aa55aa555555aa5555555555aa55aa55aa55aa55aa5100110011111111111111111105110510000000000000000
5aa55aa5555aa5555aaaaaa5555aaaa55aaaaaa55aaaaa555aaaaa555555aa5555aaaa5555aaaaa5111111111111111110511051100110010000000000000000
5aa55aa5555aa5555aa5555555555aa555555aa555555aa55aa55aa5555aa5555aa55aa555555aa5111111111051105110011001111111110000000000000000
5aa55aa5555aa5555aa5555555555aa555555aa555555aa55aa55aa5555aa5555aa55aa55a555aa5105110511001100111111111111111110000000000000000
55aaaa5555aaaa555aaaaaa55aaaaa5555555aa55aaaaa5555aaaa55555aa55555aaaa5555aaaa55100110011111111111111111105110510000000000000000
55555555555555555555555555555555555555555555555555555555555555555555555555555555111111111111111110511051100110010000000000000000
77700070077777007770007007777700777777700777777007777770000000000000000000000000000000005555555555555555555555550000000000000000
77770775777555707777007577755570777555557775555577775555000000000000000000000000000000005885588555aaaa55555cc5550000000000000000
7775707577750005777770757775007577700000777500007777500000000000000000000000000000000000888888885aa55aa555cccc550000000000000000
7775057577750000777777757777777577777770777507700777770000000000000000000000000000000000888888885aa55555577777750000000000000000
7775007577750000777577757775007577755555777500750055777000000000000000000000000000000000588888855aa55555577777750000000000000000
7775007577750070777507757775007577700000777500750000777500000000000000000000000000000000558888555aa55aa555cccc550000000000000000
77750075077777057775007577750075777777700777777577777755000000000000000000000000000000005558855555aaaa55555cc5550000000000000000
05550005005555500555000505550005055555550055555505555550000000000000000000000000000000005555555555555555555555550000000000000000
__map__
0202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000070717273707474000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000757370747600000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
02404142434445444647434048494a0202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020000424b494a4c4d4e4f505100000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0200000000000000000000000000000202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000002020202020202020202020202020202020202020202020202020202020202020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
